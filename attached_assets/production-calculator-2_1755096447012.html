<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Paper Bag Production Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #718096;
            font-size: 14px;
        }
        
        .main-layout {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 30px;
        }
        
        .input-panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            height: fit-content;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: #4a5568;
        }
        
        input, select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        .input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #4299e1;
            color: white;
            width: 100%;
        }
        
        .btn-primary:hover {
            background: #3182ce;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
        }
        
        .btn-secondary {
            background: #718096;
            color: white;
        }
        
        .results-panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .machine-card {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .machine-card.compatible {
            background: #f0fff4;
            border-color: #9ae6b4;
        }
        
        .machine-card.selected {
            background: #ebf8ff;
            border-color: #4299e1;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.15);
        }
        
        .machine-card.incompatible {
            background: #fffaf0;
            border-color: #feb2b2;
            opacity: 0.6;
        }
        
        .machine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .machine-name {
            font-weight: 600;
            font-size: 16px;
            color: #2c3e50;
        }
        
        .machine-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-available {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .status-busy {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .machine-specs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .spec-item {
            text-align: center;
        }
        
        .spec-value {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .spec-label {
            font-size: 11px;
            color: #718096;
            text-transform: uppercase;
            margin-top: 2px;
        }
        
        .capacity-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .capacity-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            transition: width 0.5s ease;
        }
        
        .production-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }
        
        .info-item {
            font-size: 13px;
        }
        
        .info-label {
            color: #718096;
        }
        
        .info-value {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .summary-card.green {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .summary-card.blue {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
        }
        
        .summary-card.orange {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
        }
        
        .summary-number {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 12px;
            opacity: 0.9;
            text-transform: uppercase;
        }
        
        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .alert-warning {
            background: #fffaf0;
            border: 1px solid #feb2b2;
            color: #742a2a;
        }
        
        .alert-success {
            background: #f0fff4;
            border: 1px solid #9ae6b4;
            color: #22543d;
        }
        
        .help-text {
            font-size: 12px;
            color: #718096;
            margin-top: 4px;
        }
        
        @media (max-width: 968px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .machine-specs {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè≠ Smart Paper Bag Production Calculator</h1>
            <p class="subtitle">Enter bag specifications to find optimal machine allocation and production timeline</p>
        </div>
        
        <div class="main-layout">
            <div class="input-panel">
                <h2 class="section-title">üìã Order Specifications</h2>
                
                <div class="form-group">
                    <label>Order Name / Reference</label>
                    <input type="text" id="orderName" placeholder="e.g., Carrefour Q1 Order">
                </div>
                
                <div class="input-group">
                    <div class="form-group">
                        <label>Bag Width (mm)</label>
                        <input type="number" id="bagWidth" placeholder="e.g., 320" min="200" max="600">
                    </div>
                    <div class="form-group">
                        <label>Bag Height (mm)</label>
                        <input type="number" id="bagHeight" placeholder="e.g., 390" min="200" max="600">
                    </div>
                </div>
                
                <div class="input-group">
                    <div class="form-group">
                        <label>Gusset (mm)</label>
                        <input type="number" id="bagGusset" placeholder="e.g., 155" min="0" max="300">
                        <div class="help-text">Leave 0 if no gusset</div>
                    </div>
                    <div class="form-group">
                        <label>Paper GSM</label>
                        <input type="number" id="paperGSM" placeholder="e.g., 85" min="70" max="150">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Paper Width Required (mm)</label>
                    <input type="number" id="paperWidth" placeholder="e.g., 990" min="700" max="1300">
                    <div class="help-text">Roll width needed for production</div>
                </div>
                
                <div class="form-group">
                    <label>Handle Type</label>
                    <select id="handleType">
                        <option value="flat">Flat Handle (FH)</option>
                        <option value="twisted">Twisted Handle (TH)</option>
                        <option value="none">No Handle</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Patch Type</label>
                    <select id="patchType">
                        <option value="none">No Patch</option>
                        <option value="single">Single Patch</option>
                        <option value="double">Double Patch</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <div class="form-group">
                        <label>Number of Colors</label>
                        <select id="colors">
                            <option value="0">No Printing</option>
                            <option value="1">1 Color</option>
                            <option value="2">2 Colors</option>
                            <option value="3">3 Colors</option>
                            <option value="4">4 Colors</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quantity (pieces)</label>
                        <input type="number" id="quantity" placeholder="e.g., 50000" min="1000">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Required Delivery (days)</label>
                    <input type="number" id="deliveryDays" placeholder="e.g., 7" min="1">
                    <div class="help-text">Number of days available for production</div>
                </div>
                
                <button class="btn btn-primary" onclick="calculateProduction()">
                    Calculate Production Plan
                </button>
            </div>
            
            <div class="results-panel">
                <h2 class="section-title">üìä Production Analysis</h2>
                <div id="results">
                    <div style="text-align: center; padding: 60px 20px; color: #718096;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üìù</div>
                        <p>Enter order specifications to see production plan</p>
                        <p style="font-size: 13px; margin-top: 10px;">The calculator will show compatible machines and optimal allocation</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Machine specifications database
        const machines = {
            'M1': {
                name: 'M1',
                category: 'GM 5QT FH',
                description: 'Garant Triumph 5QT',
                handleType: 'flat',
                maxColors: 1,
                dailyCapacity: 82000,
                speed: 100,
                minWidth: 800,
                maxWidth: 1100,
                minGSM: 70,
                maxGSM: 100
            },
            'M2': {
                name: 'M2',
                category: 'GM 5QT FH',
                description: 'Garant Triumph 5QT',
                handleType: 'flat',
                maxColors: 3,
                dailyCapacity: 82000,
                speed: 100,
                minWidth: 800,
                maxWidth: 1100,
                minGSM: 70,
                maxGSM: 100
            },
            'M3': {
                name: 'M3',
                category: 'GM 5QT FH',
                description: 'Garant Triumph 5QT',
                handleType: 'flat',
                maxColors: 3,
                dailyCapacity: 82000,
                speed: 100,
                minWidth: 800,
                maxWidth: 1100,
                minGSM: 70,
                maxGSM: 100
            },
            'M4': {
                name: 'M4',
                category: 'GM 5QT FH',
                description: 'Garant Triumph 5QT',
                handleType: 'flat',
                maxColors: 1,
                dailyCapacity: 82000,
                speed: 100,
                minWidth: 800,
                maxWidth: 1100,
                minGSM: 70,
                maxGSM: 100
            },
            'M5': {
                name: 'M5',
                category: 'GM 5F6 FH',
                description: 'Garant 5F6',
                handleType: 'flat',
                maxColors: 4,
                dailyCapacity: 82000,
                speed: 100,
                minWidth: 700,
                maxWidth: 1200,
                minGSM: 70,
                maxGSM: 110,
                supportsPatch: true
            },
            'M6': {
                name: 'M6',
                category: 'GM 5F6 TH',
                description: 'Garant 5F6',
                handleType: 'twisted',
                maxColors: 2,
                dailyCapacity: 82000,
                speed: 100,
                minWidth: 700,
                maxWidth: 1200,
                minGSM: 70,
                maxGSM: 110
            },
            'NL1': {
                name: 'NL1',
                category: 'NL FH',
                description: 'Newlong',
                handleType: 'flat',
                maxColors: 2,
                dailyCapacity: 65600,
                speed: 80,
                minWidth: 750,
                maxWidth: 1000,
                minGSM: 75,
                maxGSM: 95
            },
            'NL2': {
                name: 'NL2',
                category: 'NL FH',
                description: 'Newlong',
                handleType: 'flat',
                maxColors: 2,
                dailyCapacity: 65600,
                speed: 80,
                minWidth: 750,
                maxWidth: 1000,
                minGSM: 75,
                maxGSM: 95
            }
        };

        // Color capacity adjustment factors
        const colorFactors = {
            0: 1.0,   // No printing
            1: 1.0,   // 1 color
            2: 0.87,  // 2 colors
            3: 1.0,   // 3 colors
            4: 0.33   // 4 colors
        };

        // Check machine compatibility
        function checkMachineCompatibility(machine, specs) {
            const reasons = [];
            let compatible = true;

            // Check handle type
            if (specs.handleType !== 'none' && machine.handleType !== specs.handleType) {
                compatible = false;
                reasons.push(`Requires ${specs.handleType} handle, machine has ${machine.handleType}`);
            }

            // Check color capability
            if (specs.colors > machine.maxColors) {
                compatible = false;
                reasons.push(`Requires ${specs.colors} colors, machine supports max ${machine.maxColors}`);
            }

            // Check paper width
            if (specs.paperWidth < machine.minWidth || specs.paperWidth > machine.maxWidth) {
                compatible = false;
                reasons.push(`Paper width ${specs.paperWidth}mm outside range (${machine.minWidth}-${machine.maxWidth}mm)`);
            }

            // Check GSM
            if (specs.paperGSM < machine.minGSM || specs.paperGSM > machine.maxGSM) {
                compatible = false;
                reasons.push(`GSM ${specs.paperGSM} outside range (${machine.minGSM}-${machine.maxGSM})`);
            }

            // Check patch support
            if (specs.patchType === 'double' && !machine.supportsPatch) {
                compatible = false;
                reasons.push('Double patch not supported');
            }

            return { compatible, reasons };
        }

        // Calculate production requirements
        function calculateProductionRequirements(machine, specs) {
            const colorFactor = colorFactors[specs.colors] || 1.0;
            const adjustedCapacity = machine.dailyCapacity * colorFactor;
            
            // Adjust for patch complexity
            let patchFactor = 1.0;
            if (specs.patchType === 'single') patchFactor = 0.95;
            if (specs.patchType === 'double') patchFactor = 0.90;
            
            const finalCapacity = Math.floor(adjustedCapacity * patchFactor);
            const daysRequired = Math.ceil(specs.quantity / finalCapacity);
            const hoursRequired = (specs.quantity / (finalCapacity / 16)).toFixed(1); // 16 working hours
            const utilization = Math.min((specs.quantity / finalCapacity) * 100, 100);

            return {
                adjustedCapacity: finalCapacity,
                daysRequired,
                hoursRequired,
                utilization,
                canMeetDeadline: daysRequired <= specs.deliveryDays
            };
        }

        // Main calculation function
        function calculateProduction() {
            // Get input values
            const specs = {
                orderName: document.getElementById('orderName').value || 'New Order',
                bagWidth: parseInt(document.getElementById('bagWidth').value) || 0,
                bagHeight: parseInt(document.getElementById('bagHeight').value) || 0,
                bagGusset: parseInt(document.getElementById('bagGusset').value) || 0,
                paperGSM: parseInt(document.getElementById('paperGSM').value) || 0,
                paperWidth: parseInt(document.getElementById('paperWidth').value) || 0,
                handleType: document.getElementById('handleType').value,
                patchType: document.getElementById('patchType').value,
                colors: parseInt(document.getElementById('colors').value) || 0,
                quantity: parseInt(document.getElementById('quantity').value) || 0,
                deliveryDays: parseInt(document.getElementById('deliveryDays').value) || 7
            };

            // Validate inputs
            if (!specs.quantity || !specs.paperWidth || !specs.paperGSM) {
                alert('Please fill in all required fields');
                return;
            }

            // Analyze each machine
            const machineAnalysis = [];
            let compatibleCount = 0;
            let bestMachine = null;
            let minDays = Infinity;

            Object.values(machines).forEach(machine => {
                const compatibility = checkMachineCompatibility(machine, specs);
                const production = calculateProductionRequirements(machine, specs);
                
                const analysis = {
                    machine,
                    ...compatibility,
                    ...production
                };

                if (compatibility.compatible) {
                    compatibleCount++;
                    if (production.daysRequired < minDays) {
                        minDays = production.daysRequired;
                        bestMachine = analysis;
                    }
                }

                machineAnalysis.push(analysis);
            });

            // Display results
            displayResults(specs, machineAnalysis, bestMachine, compatibleCount);
        }

        // Display results
        function displayResults(specs, analysis, bestMachine, compatibleCount) {
            const resultsDiv = document.getElementById('results');
            
            // Summary cards
            let html = `
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="summary-number">${specs.quantity.toLocaleString()}</div>
                        <div class="summary-label">Total Pieces</div>
                    </div>
                    <div class="summary-card green">
                        <div class="summary-number">${compatibleCount}</div>
                        <div class="summary-label">Compatible Machines</div>
                    </div>
                    <div class="summary-card blue">
                        <div class="summary-number">${bestMachine ? bestMachine.daysRequired : '-'}</div>
                        <div class="summary-label">Min Days Required</div>
                    </div>
                    <div class="summary-card orange">
                        <div class="summary-number">${specs.deliveryDays}</div>
                        <div class="summary-label">Days Available</div>
                    </div>
                </div>
            `;

            // Alert if no compatible machines
            if (compatibleCount === 0) {
                html += `
                    <div class="alert alert-warning">
                        ‚ö†Ô∏è No compatible machines found for these specifications. 
                        Please adjust paper width, GSM, or handle type.
                    </div>
                `;
            } else if (bestMachine && !bestMachine.canMeetDeadline) {
                html += `
                    <div class="alert alert-warning">
                        ‚ö†Ô∏è Cannot meet delivery deadline with available machines. 
                        Consider splitting the order or extending the deadline.
                    </div>
                `;
            } else {
                html += `
                    <div class="alert alert-success">
                        ‚úÖ Production feasible! ${compatibleCount} machine${compatibleCount > 1 ? 's' : ''} can handle this order.
                    </div>
                `;
            }

            // Order details
            html += `
                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h3 style="margin-bottom: 10px; font-size: 14px; color: #4a5568;">Order: ${specs.orderName}</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; font-size: 13px;">
                        <div><span style="color: #718096;">Dimensions:</span> <strong>${specs.bagWidth}+${specs.bagGusset}x${specs.bagHeight}mm</strong></div>
                        <div><span style="color: #718096;">Paper:</span> <strong>${specs.paperGSM}GSM x ${specs.paperWidth}mm</strong></div>
                        <div><span style="color: #718096;">Handle:</span> <strong>${specs.handleType}</strong></div>
                        <div><span style="color: #718096;">Colors:</span> <strong>${specs.colors || 'No printing'}</strong></div>
                    </div>
                </div>
            `;

            // Machine cards
            html += '<h3 style="margin-bottom: 15px; font-size: 16px;">Machine Analysis</h3>';
            
            // Sort: compatible first, then by days required
            analysis.sort((a, b) => {
                if (a.compatible && !b.compatible) return -1;
                if (!a.compatible && b.compatible) return 1;
                return a.daysRequired - b.daysRequired;
            });

            analysis.forEach(item => {
                const isCompatible = item.compatible;
                const isBest = bestMachine && item.machine.name === bestMachine.machine.name;
                const cardClass = !isCompatible ? 'incompatible' : isBest ? 'selected' : 'compatible';
                
                html += `
                    <div class="machine-card ${cardClass}">
                        <div class="machine-header">
                            <div class="machine-name">
                                ${item.machine.name} - ${item.machine.description}
                                ${isBest ? '<span style="color: #4299e1; font-size: 12px;"> ‚òÖ RECOMMENDED</span>' : ''}
                            </div>
                            <div class="machine-status ${isCompatible ? 'status-available' : 'status-busy'}">
                                ${isCompatible ? 'Compatible' : 'Incompatible'}
                            </div>
                        </div>
                `;

                if (isCompatible) {
                    const utilizationColor = item.utilization > 90 ? '#f56565' : 
                                           item.utilization > 70 ? '#ed8936' : '#48bb78';
                    
                    html += `
                        <div class="machine-specs">
                            <div class="spec-item">
                                <div class="spec-value">${item.daysRequired}</div>
                                <div class="spec-label">Days</div>
                            </div>
                            <div class="spec-item">
                                <div class="spec-value">${item.adjustedCapacity.toLocaleString()}</div>
                                <div class="spec-label">Daily Output</div>
                            </div>
                            <div class="spec-item">
                                <div class="spec-value">${item.utilization.toFixed(0)}%</div>
                                <div class="spec-label">Utilization</div>
                            </div>
                        </div>
                        
                        <div class="capacity-bar">
                            <div class="capacity-fill" style="width: ${item.utilization}%; background: ${utilizationColor};"></div>
                        </div>
                        
                        <div class="production-info">
                            <div class="info-item">
                                <span class="info-label">Production Hours:</span>
                                <span class="info-value">${item.hoursRequired}h</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Meets Deadline:</span>
                                <span class="info-value" style="color: ${item.canMeetDeadline ? '#48bb78' : '#f56565'};">
                                    ${item.canMeetDeadline ? 'Yes ‚úì' : 'No ‚úó'}
                                </span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Max Colors:</span>
                                <span class="info-value">${item.machine.maxColors}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Handle Type:</span>
                                <span class="info-value">${item.machine.handleType}</span>
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div style="padding: 10px; background: #fff5f5; border-radius: 6px; margin-top: 10px;">
                            <strong style="color: #c53030; font-size: 13px;">Incompatibility Reasons:</strong>
                            <ul style="margin: 5px 0 0 20px; font-size: 12px; color: #742a2a;">
                                ${item.reasons.map(r => `<li>${r}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }

                html += '</div>';
            });

            resultsDiv.innerHTML = html;
        }

        // Add some example values on load for testing
        window.onload = function() {
            // You can uncomment these to have default values for quick testing
            // document.getElementById('bagWidth').value = '320';
            // document.getElementById('bagHeight').value = '390';
            // document.getElementById('bagGusset').value = '155';
            // document.getElementById('paperGSM').value = '85';
            // document.getElementById('paperWidth').value = '990';
            // document.getElementById('quantity').value = '50000';
            // document.getElementById('deliveryDays').value = '7';
        };
    </script>
</body>
</html>